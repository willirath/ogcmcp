[workspace]
authors = ["Willi Rath <wrath@geomar.de>"]
channels = ["conda-forge"]
name = "2026-dtg"
platforms = ["osx-arm64"]
version = "0.1.0"

[tasks]
test = "pytest tests/ -v"
index = "python -m src.indexer.pipeline"
embed = "nice -n 10 python -u -m src.embedder.pipeline"
embed-docs = "python -u -m src.docs_indexer.pipeline"
serve = "python -m src.server"
build-image    = "docker build --platform linux/amd64 -t mitgcm:latest -f docker/mitgcm/Dockerfile ."
build-mcp-image = "docker build --platform linux/amd64 -t mitgcm-mcp:latest -f docker/mcp/Dockerfile ."
setup-tutorial = "bash scripts/setup-tutorial.sh"
build-tutorial = "bash scripts/build-experiment.sh experiments/tutorial_rotating_tank"
run-tutorial   = "bash scripts/run-experiment.sh experiments/tutorial_rotating_tank"
gen-rotating-convection   = "python experiments/rotating_convection/gen.py"
build-rotating-convection = "bash scripts/build-experiment.sh experiments/rotating_convection"
run-rotating-convection   = "bash scripts/run-experiment.sh experiments/rotating_convection"

[dependencies]
python = "3.13.*"
matplotlib = ">=3.9, <4"
netcdf4 = ">=1.7, <2"

[pypi-dependencies]
duckdb = ">=1.4.4, <2"
chromadb = ">=1.0"
ollama = ">=0.6.1, <0.7"
fastapi = ">=0.129.0, <0.130"
tree-sitter = ">=0.25.2, <0.26"
tree-sitter-fortran = ">=0.5.1, <0.6"
pytest = ">=9.0.2, <10"
mcp = ">=1.0, <2"
pint = ">=0.24, <1"
